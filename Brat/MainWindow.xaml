<Window x:Class="Brat.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:local="clr-namespace:Brat"
        Title="Brat" Height="1000" Width="1800" MinHeight="600" MinWidth="900" WindowStartupLocation="CenterScreen"
        FontFamily="pack://application:,,,/Brat;component/Fonts/#SF Pro Rounded"        
        xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
        Background="#2D2D2D" Loaded="Window_Loaded" KeyDown="Window_KeyDown">
    <Window.Resources>
        <!-- Палитра -->
        <SolidColorBrush x:Key="Col.AppBg"     Color="#2D2D2D"/>
        <SolidColorBrush x:Key="Col.Rail"      Color="#5A5A5A"/>
        <SolidColorBrush x:Key="Col.Side"      Color="#3A3A3A"/>
        <SolidColorBrush x:Key="Col.Top"       Color="#444444"/>
        <SolidColorBrush x:Key="Col.Input"     Color="#444444"/>
        <SolidColorBrush x:Key="Col.BubbleL"   Color="#E6E6E6"/>
        <SolidColorBrush x:Key="Col.BubbleR"   Color="#0078D7"/>

        <!-- Иконка-кнопка (круг) -->
        <Style x:Key="IconButton" TargetType="Button">
            <Setter Property="Width" Value="36"/>
            <Setter Property="Height" Value="36"/>
            <Setter Property="Background" Value="#505050"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#6A6A6A"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border CornerRadius="18"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Макет одного элемента чата -->
        <!--<DataTemplate x:Key="ChatItemTemplate">
            <Grid Height="52" Margin="-6, 0, 0, 0" Width="301">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="52"/>
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Ellipse Width="42" Height="42" Fill="#D9D9D9" VerticalAlignment="Center" Margin="5,0,0,0"/>
                <StackPanel Grid.Column="1" Margin="5,0,0,0" VerticalAlignment="Center">
                    <StackPanel Height="15" Width="216" HorizontalAlignment="Left">
                        <TextBlock Text="Грант Упизмо" FontSize="14" Foreground="#FFE2E2E2" FontFamily="SF Pro Rounded"/>
                    </StackPanel>
                    <StackPanel Height="15" Width="216" Margin="0, 5, 0, 0" HorizontalAlignment="Left">
                        <TextBlock Text="Иди нахуй" FontSize="14" FontWeight="Normal" Foreground="#FFA4A4A4" FontFamily="SF Pro Rounded"/>
                    </StackPanel>
                </StackPanel>
            </Grid>
        </DataTemplate>-->

        <!-- Пузырьки -->
        <Style x:Key="BubbleLeft" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource Col.BubbleL}"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="Margin" Value="8"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
        </Style>
        <Style x:Key="BubbleRight" TargetType="Border" BasedOn="{StaticResource BubbleLeft}">
            <Setter Property="Background" Value="{StaticResource Col.BubbleR}"/>
            <Setter Property="HorizontalAlignment" Value="Right"/>
        </Style>

        <!-- Убираем выделение у ListBoxItem (скелет-лист) -->
        <Style TargetType="ListBoxItem">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Focusable" Value="False"/>
        </Style>
    </Window.Resources>

    <!-- ===== ГЛАВНАЯ СЕТКА: 3 колонки (рейл / чаты / сообщения) и 3 строки ===== -->
    <Grid Background="{StaticResource Col.Input}">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="64"/>
            <!-- узкий рейл -->
            <ColumnDefinition Width="300"/>
            <!-- список чатов -->
            <ColumnDefinition Width="*"/>
            <!-- область переписки -->
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="48"/>
            <!-- верхняя плашка -->
            <RowDefinition Height="*"/>
            <!-- контент -->
            <RowDefinition Height="60"/>
            <!-- нижняя плашка ввода (только для переписки) -->
        </Grid.RowDefinitions>

        <!-- ВЕРХНЯЯ ПАНЕЛЬ — на всю ширину -->
        <Border Grid.Row="0" Grid.Column="2" Background="{StaticResource Col.Top}">
            <Grid Margin="16,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="Заголовок чата" Foreground="White" VerticalAlignment="Center" FontWeight="Bold"/>
                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <Button Style="{StaticResource IconButton}" Content="…"/>
                    <Button Style="{StaticResource IconButton}" Content="≡"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ЛЕВЫЙ РЕЙЛ -->
        <Grid Grid.RowSpan="3" Grid.Column="0" Background="{StaticResource Col.Rail}">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <StackPanel Margin="12,12,12,0">
                <Ellipse Width="40" Height="40" Fill="#D9D9D9"/>
                <TextBlock Text="Я даун" Foreground="White" Margin="0,8,0,0" FontWeight="SemiBold"/>
            </StackPanel>
            <Button Grid.Row="2" Style="{StaticResource IconButton}" Content="★" Margin="12" Background="#4F4F4F"/>
        </Grid>

        <!-- КОЛОНКА СО СПИСКОМ ЧАТОВ -->
        <Grid Grid.RowSpan="3" Grid.Column="1" Background="{StaticResource Col.Side}">
            <Grid.RowDefinitions>
                <RowDefinition Height="56"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Поиск -->
            <Border Margin="12" Background="#5A5A5A" CornerRadius="20" Height="36" VerticalAlignment="Center">
                <Grid Margin="12,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="24"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Ellipse Fill="#9E9E9E" Width="14" Height="14" VerticalAlignment="Center"/>
                    <TextBlock Grid.Column="1" VerticalAlignment="Center" Foreground="#E5E5E5" Text="Найти" FontSize="14"/>
                </Grid>
            </Border>

            <!-- Макеты элементов чатов -->
            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Hidden">
                <ListBox x:Name="UsersList" Background="Transparent" BorderThickness="0" SelectionChanged="ListBox_SelectionChanged" HorizontalAlignment="Center" MouseLeftButtonUp="UsersList_MouseLeftButtonUp">
                    <!-- 12 «болванок» -->
                    
                </ListBox>
            </ScrollViewer>
        </Grid>

        <!-- Разделитель «Непрочитанные сообщения» -->
        <!-- Border Background="#666666" Height="15" Margin="0,12">
            <TextBlock Text="Непрочитанные сообщения" Foreground="White"
                                   FontSize="12" VerticalAlignment="Center" HorizontalAlignment="Center"/></Border-->
        <!-- ОБЛАСТЬ СООБЩЕНИЙ -->
        <Grid Grid.Row="1" Grid.Column="2" Background="{StaticResource Col.Input}">
            <ScrollViewer Padding="24,16" x:Name="chatScroll" VerticalScrollBarVisibility="Hidden">
                <StackPanel x:Name="ChatField" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock FontSize="24" Text="Выберите, кому вы хотите написать..." Foreground="White" FontFamily="pack://application:,,,/Brat;component/Fonts/#SF Pro Rounded"/>
                </StackPanel>
            </ScrollViewer>
        </Grid>

        <!-- НИЖНЯЯ ПАНЕЛЬ ВВОДА — только под областью сообщений -->
        <Border Grid.Row="2" Grid.Column="2" Background="{StaticResource Col.Side}" BorderThickness="0" x:Name="borderEnterField" Visibility="Hidden">
            <Grid Margin="12,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="56"/>
                </Grid.ColumnDefinitions>
                <Border Background="#5A5A5A" CornerRadius="8" Height="40" VerticalAlignment="Center" Margin="0,0,8,0">
                    <xctk:WatermarkTextBox x:Name="mainTextBox" BorderThickness="0" Background="Transparent" Foreground="White"
                             Padding="12,12" FontSize="14" Watermark="Сообщение..." KeyDown="mainTextBox_KeyDown" >

                    </xctk:WatermarkTextBox>
                </Border>
                <Button x:Name="SendMessage" Grid.Column="1" Content="➤" FontSize="18" FontWeight="Bold"
                        Background="#5A5A5A" Foreground="White" BorderThickness="0"
                        Width="56" Height="40" VerticalAlignment="Center" Click="SendMessage_Click"/>
            </Grid>
        </Border>
    </Grid>
</Window>
